C FL STUDIO KEYBOARD
      INCLUDE 'MINICRT.FI'
      INTEGER*1 LASTSCAN,K,LASTK,SHIFTS
      INTEGER*2 N,LASTN,OCTAVE,PEEKW
      DIMENSION SHIFTS(51)
      DATA SHIFTS/14,16,0,19,21,23,0,26,28,0,0,0,0,13,15,17,18,20,22,24,
     125,27,29,0,0,0,0,0,2,4,0,7,9,11,0,14,16,0,0,0,0,1,3,5,6,8,10,12,
     213,15,17/
5     FORMAT (1X,'CURRENT OCTAVES: ',I1,'-',I1)
      CALL INITCRT
      OCTAVE=4
      LASTN=0
      WRITE(6,*) 'PRESS ESC TO EXIT'
      WRITE(6,*) 'PRESS ARROWS UP/DOWN FOR OCTAVE UP/DOWN'
      WRITE(6,*) '2356790 Q-P SDGHJL; Z-/ ARE NOTES'
10    LASTK=K
      K=LASTSCAN()
      CALL POKEB(-18432,(80*12+79)*2,K)
      IF (K.GT.0) GO TO 20
      IF (LASTN.EQ.0) GO TO 10
      LASTN=0
      CALL NOSOUND
      GO TO 10
20    CALL POKEW(64,28,PEEKW(64,26))
      N=OCTAVE*12
      IF (K.EQ.1) GO TO 350
      IF (K.EQ.72) GO TO 30
      IF (K.EQ.80) GO TO 40
      IF (K.LT.3.OR.K.GT.53) GO TO 10
      IF (SHIFTS(K-2).EQ.0) GO TO 10
      N=N+SHIFTS(K-2)
      IF (LASTN.NE.N) CALL PLAYNUM(N)
      LASTN=N
      GO TO 10
30    IF (OCTAVE.GE.8.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE+1
      GO TO 50
40    IF (OCTAVE.LE.0.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE-1
50    WRITE(6,5)OCTAVE,OCTAVE+1
      GO TO 10
350   WRITE(6,*)'BYE!'
      CALL NOSOUND
      END
