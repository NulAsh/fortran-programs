C FL STUDIO KEYBOARD
      INCLUDE 'MINICRT.FI'
      INTEGER*1 LASTSCAN,K,LASTK
      INTEGER*2 N,LASTN,OCTAVE,PEEKW
5     FORMAT (1X,'CURRENT OCTAVES: ',I1,'-',I1)
      CALL INITCRT
      OCTAVE=4
      LASTN=0
      WRITE(6,*) 'PRESS ESC TO EXIT'
      WRITE(6,*) 'PRESS ARROWS UP/DOWN FOR OCTAVE UP/DOWN'
      WRITE(6,*) '2356790 Q-P SDGHJL; Z-/ ARE NOTES'
10    LASTK=K
      K=LASTSCAN()
      CALL POKEB(-18432,(80*12+79)*2,K)
      IF (K.GT.0) GO TO 20
      IF (LASTN.EQ.0) GO TO 10
      LASTN=0
      CALL NOSOUND
      GO TO 10
20    CALL POKEW(64,28,PEEKW(64,26))
      N=OCTAVE*12
      IF (K.EQ.1) GO TO 350
      IF (K.LT.3) GO TO 10
      IF (K.EQ.72) GO TO 30
      IF (K.EQ.80) GO TO 40
      GO TO (210,190,10,160,140,120,10,90,70,10,10,10,10,220,200,180,
     1170,150,130,110,100,80,60,10,10,10,10,10,330,310,10,280,260,240,
     210,210,190,10,10,10,10,340,320,300,290,270,250,230,220,200,180)K-2
      GO TO 10
30    IF (OCTAVE.GE.8.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE+1
      GO TO 50
40    IF (OCTAVE.LE.0.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE-1
50    WRITE(6,5)OCTAVE,OCTAVE+1
      GO TO 10
60    N=N+1
70    N=N+1
80    N=N+1
90    N=N+1
100   N=N+1
110   N=N+1
120   N=N+1
130   N=N+1
140   N=N+1
150   N=N+1
160   N=N+1
170   N=N+1
180   N=N+1
190   N=N+1
200   N=N+1
210   N=N+1
220   N=N+1
230   N=N+1
240   N=N+1
250   N=N+1
260   N=N+1
270   N=N+1
280   N=N+1
290   N=N+1
300   N=N+1
310   N=N+1
320   N=N+1
330   N=N+1
340   N=N+1
      IF (LASTN.NE.N) CALL PLAYNUM(N)
      LASTN=N
      GO TO 10
350   WRITE(6,*)'BYE!'
      CALL NOSOUND
      END
