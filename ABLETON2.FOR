C ABLETON KEYBOARD
      INCLUDE 'MINICRT.FI'
      LOGICAL*1 ISANYKEYDOWN,KEYPRESSED
      INTEGER*1 RDK_INT,LASTSCAN,K,LASTK
      INTEGER*2 N,LASTN,OCTAVE
5     FORMAT (1X,'CURRENT OCTAVE: ',I1)
      CALL INITCRT
      OCTAVE=3
      LASTN=0
      WRITE(6,*) 'PRESS ESC TO EXIT'
      WRITE(6,*) 'PRESS Z FOR OCTAVE DOWN, X FOR OCTAVE UP'
      WRITE(6,*) 'A-L AND WETYUO ARE NOTES'
10    LASTK=K
      IF (ISANYKEYDOWN()) GO TO 20
      IF (LASTN.EQ.0) GO TO 10
      LASTN=0
      CALL NOSOUND
      GO TO 10
20    IF (.NOT.KEYPRESSED()) GO TO 30
      K=RDK_INT()
      GOTO 20
30    N=OCTAVE*12
      K=LASTSCAN()
      IF (K.EQ.1) GO TO 220
      IF (K.LT.17) GO TO 10
      GO TO (200,180,10,150,130,110,10,80,10,10,10,10,10,210,190,170,
     1160,140,120,100,90,70,10,10,10,10,10,50,40)K-16
      GO TO 10
40    IF (OCTAVE.GE.8.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE+1
      GO TO 60
50    IF (OCTAVE.LE.0.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE-1
60    WRITE(6,5)OCTAVE
      GO TO 10
70    N=N+1
80    N=N+1
90    N=N+1
100   N=N+1
110   N=N+1
120   N=N+1
130   N=N+1
140   N=N+1
150   N=N+1
160   N=N+1
170   N=N+1
180   N=N+1
190   N=N+1
200   N=N+1
210   N=N+1
      IF (LASTN.NE.N) CALL PLAYNUM(N)
      LASTN=N
      GO TO 10
220   WRITE(6,*)'BYE!'
      CALL NOSOUND
      END
