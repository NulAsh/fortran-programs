C ABLETON KEYBOARD
      INCLUDE 'MINICRT.FI'
      LOGICAL*1 ISANYKEYDOWN,KEYPRESSED
      INTEGER*1 RDK_INT,K,OCTAVE,LASTN
      INTEGER*2 N
5     FORMAT (1X,'CURRENT OCTAVE: ',I1)
      CALL INITCRT
      OCTAVE=3
      LASTN=0
      WRITE(6,*) 'PRESS ESC TO EXIT'
      WRITE(6,*) 'PRESS Z FOR OCTAVE DOWN, X FOR OCTAVE UP'
      WRITE(6,*) 'A-L AND WETYUO ARE NOTES'
10    IF (ISANYKEYDOWN()) GO TO 20
      IF (LASTN.EQ.0) GO TO 10
      LASTN=0
      CALL NOSOUND
      GO TO 10
20    IF (.NOT.KEYPRESSED()) GO TO 10
      N=OCTAVE*12
      K=RDK_INT()
      IF (K.EQ.27) GO TO 340
      IF (K.GE.97.AND.K.LE.122) K=K-32
      IF (K-77) 30,10,40
30    IF (K-71) 50,60,70
40    IF (K-84) 80,90,100
50    IF (K-68) 110,120,130
60    N=N+8
      GO TO 330
70    IF (K-74) 140,150,160
80    IF (K-79) 10,170,180
90    N=N+7
      GO TO 330
100   IF (K-88) 190,200,210
110   IF (K-65) 10,220,10
120   N=N+5
      GO TO 330
130   IF (K-70) 230,240,10
140   IF (K-72) 10,250,10
150   N=N+12
      GO TO 330
160   IF (K-76) 260,270,10
170   N=N+14
      GO TO 330
180   IF (K-83) 10,280,10
190   IF (K-86) 290,10,300
200   IF (OCTAVE.GE.8) GO TO 10
      OCTAVE=OCTAVE+1
      WRITE(6,5)OCTAVE
      GO TO 10
210   IF (K-90) 310,320,10
220   N=N+1
      GO TO 330
230   N=N+4
      GO TO 330
240   N=N+6
      GO TO 330
250   N=N+10
      GO TO 330
260   N=N+13
      GO TO 330
270   N=N+15
      GO TO 330
280   N=N+3
      GO TO 330
290   N=N+11
      GO TO 330
300   N=N+2
      GO TO 330
310   N=N+9
      GO TO 330
320   IF (OCTAVE.LE.0) GO TO 10
      OCTAVE=OCTAVE-1
      WRITE(6,5)OCTAVE
      GO TO 10
330   IF (LASTN.NE.N) CALL PLAYNUM(N)
      LASTN=N
      GO TO 10
340   WRITE(6,*)'BYE!'
      CALL NOSOUND
      END
