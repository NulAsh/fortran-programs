C ABLETON KEYBOARD
      INCLUDE 'MINICRT.FI'
      INTEGER*1 LASTSCAN,K,LASTK,SHIFTS
      INTEGER*2 N,LASTN,OCTAVE,PEEKW
      DIMENSION SHIFTS(22)
      DATA SHIFTS/2,4,0,7,9,11,0,14,0,0,0,0,0,1,3,5,6,8,10,12,13,15/
5     FORMAT (1X,'CURRENT OCTAVE: ',I1)
      CALL INITCRT
      OCTAVE=3
      LASTN=0
      WRITE(6,*) 'PRESS ESC TO EXIT'
      WRITE(6,*) 'PRESS Z FOR OCTAVE DOWN, X FOR OCTAVE UP'
      WRITE(6,*) 'A-L AND WETYUO ARE NOTES'
10    LASTK=K
      K=LASTSCAN()
      CALL POKEB(-18432,(80*12+79)*2,K)
      IF (K.GT.0) GO TO 20
      IF (LASTN.EQ.0) GO TO 10
      LASTN=0
      CALL NOSOUND
      GO TO 10
20    CALL POKEW(64,28,PEEKW(64,26))
      N=OCTAVE*12
      IF (K.EQ.1) GO TO 60
      IF (K.EQ.44) GO TO 30
      IF (K.EQ.45) GO TO 40
      IF (K.LT.17.OR.K.GT.38) GO TO 10
      IF (SHIFTS(K-16).EQ.0) GO TO 10
      N=N+SHIFTS(K-16)
      IF (LASTN.NE.N) CALL PLAYNUM(N)
      LASTN=N
      GO TO 10
30    IF (OCTAVE.LE.0.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE-1
      GO TO 50
40    IF (OCTAVE.GE.8.OR.K.EQ.LASTK) GO TO 10
      OCTAVE=OCTAVE+1
50    WRITE(6,5)OCTAVE
      GO TO 10
60    WRITE(6,*)'BYE!'
      CALL NOSOUND
      END
